"use strict";const radio1=document.querySelector(".js_radio1"),radio2=document.querySelector(".js_radio2"),radio3=document.querySelector(".js_radio3"),radio4=document.querySelector(".js_radio4"),radio5=document.querySelector(".js_radio5"),radio6=document.querySelector(".js_radio6"),previewCard=document.querySelector(".js_preview-card"),previewName=document.querySelector(".js-preview-name"),previewJob=document.querySelector(".js-preview-job"),previewMail=document.querySelector(".js_mail"),previewLinkedin=document.querySelector(".js_linkedin"),previewGithub=document.querySelector(".js_github"),fill=document.querySelector(".js_fill"),nameInput=document.querySelector(".js-name"),jobInput=document.querySelector(".js-job"),mailInput=document.querySelector(".js-mail"),phoneInput=document.querySelector(".js-phone"),linkedinInput=document.querySelector(".js-linkedin"),githubInput=document.querySelector(".js-github"),nameDefault=previewName.textContent,jobDefault=previewJob.textContent,btnReset=document.querySelector(".js_btnreset"),createBtn=document.querySelector(".botom-share"),linkUrl=document.querySelector(".url"),msjError=document.querySelector(".error"),success=document.querySelector(".js_share-success"),twitter=document.querySelector(".twitter"),fr=new FileReader,fileField=document.querySelector(".js__profile-upload-btn"),profileImage=document.querySelector(".js__profile-image"),profilePreview=document.querySelector(".js__profile-preview"),inputsValues=[nameInput,jobInput,mailInput,phoneInput,linkedinInput,githubInput],twitterLink=document.querySelector(".url-twitter");let data={palette:"1",name:previewName.textContent,job:previewJob.textContent,phone:"",email:"",linkedin:"",github:"",photo:""};const collapsedHeader=document.querySelectorAll(".js-fieldset__header"),collapsedContainer=document.querySelectorAll(".js-fieldset__container"),fieldset=document.querySelectorAll(".js-fieldset"),allArrow=document.querySelectorAll(".js_arrow");function handleClickForm(e){const t=e.currentTarget.parentNode;for(let e=0;e<fieldset.length;e++)fieldset[e]===t?(collapsedContainer[e].classList.remove("collapsed"),allArrow[e].classList.add("arrowUp")):(collapsedContainer[e].classList.add("collapsed"),allArrow[e].classList.remove("arrowUp"))}for(const e of collapsedHeader)e.addEventListener("click",handleClickForm);function remove(){previewCard.classList.contains("palette1")?previewCard.classList.remove("palette1"):previewCard.classList.contains("palette2")?previewCard.classList.remove("palette2"):previewCard.classList.contains("palette3")?previewCard.classList.remove("palette3"):previewCard.classList.contains("palette4")?previewCard.classList.remove("palette4"):previewCard.classList.contains("palette5")?previewCard.classList.remove("palette5"):previewCard.classList.contains("palette6")&&previewCard.classList.remove("palette6")}function clickRadio1(){remove(),previewCard.classList.add("palette1"),data.palette="1",localStorage.setItem("cardData",JSON.stringify(data))}function clickRadio2(){remove(),previewCard.classList.add("palette2"),data.palette="2",localStorage.setItem("cardData",JSON.stringify(data))}function clickRadio3(){remove(),previewCard.classList.add("palette3"),data.palette="3",localStorage.setItem("cardData",JSON.stringify(data))}function clickRadio4(){remove(),previewCard.classList.add("palette4"),data.palette="4",localStorage.setItem("cardData",JSON.stringify(data))}function clickRadio5(){remove(),previewCard.classList.add("palette5"),data.palette="5",localStorage.setItem("cardData",JSON.stringify(data))}function clickRadio6(){remove(),previewCard.classList.add("palette6"),data.palette="6",localStorage.setItem("cardData",JSON.stringify(data))}radio1.addEventListener("click",clickRadio1),radio2.addEventListener("click",clickRadio2),radio3.addEventListener("click",clickRadio3),radio4.addEventListener("click",clickRadio4),radio5.addEventListener("click",clickRadio5),radio6.addEventListener("click",clickRadio6);const cardLS=JSON.parse(localStorage.getItem("cardData"));function init(){cardLS&&(data=cardLS,renderPreview(data))}function renderPreview(){previewName.innerHTML=""===data.name?nameDefault:data.name,previewJob.innerHTML=""===data.job?jobDefault:data.job,previewMail.href="mailto:"+data.email,previewLinkedin.href="http://linkedin.com/company/"+data.linkedin,previewGithub.href="http://github.com/"+data.github,""===data.photo?profileImage.style.backgroundImage="url(./assets/images/preview-card-img.jpg)":profileImage.style.backgroundImage=`url(${data.photo})`,"1"===data.palette?(previewCard.classList.add("palette1"),previewCard.classList.remove("palette2"),previewCard.classList.remove("palette3"),previewCard.classList.remove("palette4"),previewCard.classList.remove("palette5"),previewCard.classList.remove("palette6"),radio1.checked=!0):"2"===data.palette?(previewCard.classList.add("palette2"),previewCard.classList.remove("palette1"),previewCard.classList.remove("palette3"),previewCard.classList.remove("palette4"),previewCard.classList.remove("palette5"),previewCard.classList.remove("palette6"),radio2.checked=!0):"3"===data.palette?(previewCard.classList.add("palette3"),previewCard.classList.remove("palette2"),previewCard.classList.remove("palette1"),previewCard.classList.remove("palette4"),previewCard.classList.remove("palette5"),previewCard.classList.remove("palette6"),radio3.checked=!0):"4"===data.palette?(previewCard.classList.add("palette4"),previewCard.classList.remove("palette1"),previewCard.classList.remove("palette3"),previewCard.classList.remove("palette2"),previewCard.classList.remove("palette5"),previewCard.classList.remove("palette6"),radio4.checked=!0):"5"===data.palette?(previewCard.classList.add("palette5"),previewCard.classList.remove("palette1"),previewCard.classList.remove("palette3"),previewCard.classList.remove("palette2"),previewCard.classList.remove("palette4"),previewCard.classList.remove("palette6"),radio5.checked=!0):"6"===data.palette&&(previewCard.classList.add("palette6"),previewCard.classList.remove("palette1"),previewCard.classList.remove("palette3"),previewCard.classList.remove("palette2"),previewCard.classList.remove("palette4"),previewCard.classList.remove("palette5"),radio6.checked=!0)}function handlerInputs(e){const t=e.target.id,a=e.target.value;data[t]=a,renderPreview(),localStorage.setItem("cardData",JSON.stringify(data))}function handleclickReset(e){e.preventDefault();for(let e in data)data[e]="";mailInput.value="",phoneInput.value="",jobInput.value="",nameInput.value="",linkedinInput.value="",githubInput.value="",profileImage.style.backgroundImage="url(./assets/images/preview-card-img.jpg)",profilePreview.style.backgroundImage="",renderPreview(),remove(),previewCard.classList.add("palette1"),radio1.checked=!0,localStorage.setItem("cardData","")}function getImage(e){const t=e.currentTarget.files[0];fr.addEventListener("load",writeImage),fr.readAsDataURL(t)}function writeImage(){profileImage.style.backgroundImage=`url(${fr.result})`,profilePreview.style.backgroundImage=`url(${fr.result})`,data.photo=fr.result,localStorage.setItem("cardData",JSON.stringify(data))}function handleClickCreate(e){msjError.innerHTML="",e.preventDefault();let t=!0;""===data.palette&&(msjError.innerHTML+="Elige algún color de la sección diseña </br>",t=!1);for(let e in inputsValues)""===inputsValues[e].value&&(msjError.innerHTML+=`Rellena el campo ${inputsValues[e].name} <br>`,t=!1);!0===t&&fetch("https://dev.adalab.es/api/card/",{method:"POST",body:JSON.stringify(data),headers:{"content-type":"application/json"}}).then(e=>e.json()).then(e=>{e.success?(linkUrl.innerHTML=`<a target="_blank" href="${e.cardURL}">${e.cardURL}</a>`,success.classList.remove("collapsed"),twitter.classList.remove("collapsed"),twitterLink.href="https://twitter.com/intent/tweet?text=Os%20comparto%20mi%20tarjeta%20de%20contacto:&url="+e.cardURL,msjError.innerHTML=""):msjError.innerHTML='Las tres lunas de marte no están alineadas, inténtalo de nuevo...<br><img class="img-error-one" src="./assets/images/error-one.gif">'})}init(),fill.addEventListener("keyup",handlerInputs),btnReset.addEventListener("click",handleclickReset),fileField.addEventListener("change",getImage),createBtn.addEventListener("click",handleClickCreate);